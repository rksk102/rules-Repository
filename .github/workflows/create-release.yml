name: "4. Release SRS"

on:
  # âœ… åªæ¥å—æ€»æŒ‡æŒ¥æ‰‹åŠ¨è§¦å‘
  workflow_dispatch:

permissions:
  contents: write  # å¿…é¡»èµ‹äºˆå†™æƒé™æ‰èƒ½å‘å¸ƒ Release

jobs:
  pack-and-ship:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¥ Checkout Scripts
        uses: actions/checkout@v4

      # ğŸ”¥ å…³é”®æ­¥éª¤ï¼šä¸‹è½½ä¹‹å‰æ­¥éª¤ç”Ÿæˆçš„ merged-rules æ–‡ä»¶å¤¹
      # å‰æï¼šä½ åœ¨ Step 2 (merge-rules.yml) ä¸­å¿…é¡»å·²ç» upload äº†åä¸º 'merged-rules-collection' çš„ artifact
      - name: ğŸ“¦ Download Rules Artifacts
        uses: actions/download-artifact@v4
        with:
          name: merged_rules_artifact  # è¿™é‡Œçš„åå­—è¦å’Œä½ ä¸Šä¼ æ—¶çš„åå­—ä¸€è‡´ï¼
          path: merged-rules           # ä¸‹è½½åˆ°å½“å‰ç›®å½•ä¸‹çš„ merged-rules æ–‡ä»¶å¤¹

      - name: ğŸ Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      - name: ğŸš€ Run Release Script
        env:
          GH_TOKEN: ${{ github.token }}  # è„šæœ¬å†…éƒ¨è°ƒç”¨ gh å‘½ä»¤éœ€è¦ token
        run: |
          chmod +x scripts/release_handler.py
          python3 scripts/release_handler.py
